---
title: 'Agent/Environment Symmetry and Entropy/Free Energy Duality'
date: 2022-04-30
permalink: /posts/2022/04/FEP-MaxEnt/
layout: post
usemathjax: true
tags:
  - projects and papers
  - reading guides
---

To zoom way out, there are really two things going on in this paper: one is the aim, and the other is the method. It's best read with this dichotomy in mind, in that the point of the paper can seem detached from the techniques used if one doesn't. We _aim_ to place an example of the FEP on solid mathematical ground. This has sort of been done in the monograph and key prior papers (e.g., a Fri2012, PDCF2019), but they're all a bit rough, especially when it comes to questions about ergodicity, stationarity, approximate Bayesian inference, and solenoidal flows, questions which have been famously kicked around in the literature. The problem with grounding the free energy principle in solid maths and physics is that free energy is sort of mysterious. There's not a lot of work showing what properties it has, especially not in probability theory, which is unfortunately key to the questions we wish to answer (if we wish to answer them formally). There's some [very nice work](https://cedricvillani.org/sites/dev/files/old_images/2012/07/P01.MV-FPReview.pdf) out there looking at entropy in a potential, whose maximum is identical to a free energy minimum. And there's a tonne on formal work on entropy. That motivated me to introduce entropy as the object of interest, rather than free energy, without loss of generality. This equivalence is actually proven throughout Section 4 of the paper, and it turns out we can get everything from the FEP back from entropy in a potential (this is how we think of duality in physics, cf. AdS/CFT correspondence, S and T duality), that every calculation has a corresponding item on the other side of the duality). But there's a second, more subtle transformation, which I've tried to call attention to: entropy in a potential only really makes sense if we look at the potential (and thus entropy) as something on agent states, rather than environmental states. Maybe that seems innocuous enough to you, or maybe you object to that; it turns out we need to do quite a lot of work to make sense of this mathematically, but conceptually it's the same; indeed, we get everything from the FEP back, just through a different lens. This is exemplified in an adjunction, a type of mathematical relationship which _always_ hides some highly non-trivial structure behind an apparently simple pair of opposites. The sequence I'm talking about is evident in Section 4, where we explicitly pass from free energy to an entropy functional on beliefs to a self-entropy under a constraint. Sections 2 and 3 are all the backdrop to that sequence, motivating the _techniques_ usedâ€”_not_ the paper itself. So remember: in [Sak22], we don't set out to rewrite the FEP. We just need some better leverage to make sense of it, so we transform it a little. To quote Chris Buckley, we've left the front, made gains elsewhere, and returned with new weapons. This is a common enough way of working in pure mathematics, but can be a bit tricky to get right. It's also tough to read without deconstructing things a bit, but hopefully I've taken care of that here. 

The partner to this paper is [RSTK+22], which _does_ take all of this new stuff and contextualise it within the FEP. This also has a dichotomy in aim and method, which again risks seeming incoherent, but actually makes it doubly interesting (or interesting for potentially different reasons, in any case): under Maxwell Ramstead's incisive eye and the collective effort of the entire R&D Group, we _aim_ to bring the construction more firmly to the FEP. My paper gets away from the FEP in several spots where entropy really takes over (there's a joke somewhere in there), and it has some unexplored implications for what the future of the FEP might look like, that we really wanted to address. The way this is achieved is largely by taking that construction and making it readable. This is not trivial: my paper is purely formal. Although not the stated aim, in effect I treat the FEP as an interesting question in biophysics that justifies doing some nice maths. It turns out I don't need to think about free energy at all, and we're off. The group's paper actually focusses on the FEP and relates these new results, derived in the context of entropy, to existing (and hopefully future) results in the FEP. 
