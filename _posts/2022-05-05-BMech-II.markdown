---
title: 'A Working Definition of Bayesian Mechanics (Bayesian Mechanics II)'
date: 2022-05-05
permalink: /posts/2022/05/BMech-II/
layout: post
usemathjax: true
tags:
  - projects and papers
  - reading guides
---

In a [previous blog post](https://darsakthi.github.io/posts/2022/04/BMech-I/), I discussed a paper of mine about Bayesian mechanics (cited here as [[Sak22]](https://arxiv.org/abs/2204.11900)). Here I'll do a deep dive on Sections 2.3, 3, and the preface to 4 (i.e., up to 4.1).

The primary aim of these sections is to define Bayesian mechanics. Work in mathematical physics generally falls into one of two broad classes of question: physically inspired mathematics or mathematically rigorous physics. The former usually means discovering new and interesting mathematical structures using physical intuition or inspiration, like Donaldson theory. The latter means looking at a physical problem through a comprehensive and exacting mathematical lens, like the ongoing efforts to formulate quantum field theory rigorously. This is actually a good example: we have a collection of phenomenological results about what QFT should do and we know roughly what different facets of it ought to look like, but have no set of axioms, or even a definition, for QFT in four space-time dimensions. We simply don't know enough about QFT to say how it should look from first principles, and the existing maths is insufficient to make it work non-perturbatively (read: without approximations of some sort). Here, at a high level, we want to get an axiomatic framework for some sort of mathematical biophysics. I do this by using the structure already put in place by the FEP.

More particularly, in the paper, I make an effort to define Bayesian mechanics, foreshadowing a hopeful connection to genuinely complex systems. The main result is in some sense Theorem 4.2. From the previous post: "from the very top, one of the contributions of the paper is to define a simple version of Bayesian mechanics. Under the free energy principle, Bayesian mechanics is the physical theory describing what systems that engage in approximate Bayesian inference do. The approximate Bayesian inference lemma in the monograph (here, upgraded to a theorem) is the observation that systems can be modelled as minima of variational free energy, since this records tautologies about what systems do and how they are perturbed by their environments. I define BMech under the FEP by formulating it in terms of an equivalent structure, maximum entropy. This work is in some sense a sequel to [this paper](https://arxiv.org/abs/2106.13830) by Da Costa et al—or, as I remark in Section 2.1, perhaps it's a prequel."

Another bit of meta-commentary about this; when we have a hard problem in mathematics, it is common to prove things about a simpler problem that we can recover the hard problem from. I resist any insinuation that this work is of the calibre of Wiles' proof of Fermat's last theorem, but this is how Wiles proved Fermat's last theorem—instead of proving a difficult number-theoretic result about Diophantine equations, he was able to prove an easier (relatively speaking) but equivalent statement about certain modular curves. This got him the result he needed.

In fact, I'll be brief in my coverage of Sections 2.3 and 3, since I think these are fairly self-explantory. Section 2.3 introduces the idea that we can switch from free energy over beliefs to constrained entropy over states, and that this symmetry is no accident. Section 3 deconstructs what the latter could actually mean. 

Section 4 is the first of two big sets of results, and in S4 we meet approximate Bayesian inference and Bayesian mechanics.

----

The problem with grounding the free energy principle in solid maths and physics is that free energy itself is sort of mysterious. There's not a lot of work showing what properties it has, especially not in probability theory, which is key to the questions we wish to answer (if we wish to answer them formally). However, there's some [very nice work](https://cedricvillani.org/sites/dev/files/old_images/2012/07/P01.MV-FPReview.pdf) out there looking at entropy in a potential, whose maximum is identical to a free energy minimum. And there's a tonne of formal work on entropy. That motivated me to introduce entropy as the object of interest, rather than free energy, without loss of generality. This equivalence is actually proven throughout Section 4 of the paper, and it turns out we can get everything from the FEP back from entropy in a potential (this is how we think of duality in physics, cf. the holographic principle, S and T duality, double copy gravity; that every calculation has a corresponding item on the other side of the duality). But there's a second, more subtle transformation, which I've tried to call attention to: entropy in a potential only really makes sense if we look at the potential (and thus entropy) as something on an agent's states, rather than environmental states. Maybe that seems innocuous enough to you, or maybe you object to that; it turns out we need to do quite a lot of work to make sense of this mathematically, but conceptually it's quite the same thing. Indeed, we get everything from the FEP back, just through a different lens. This is exemplified in an adjunction, a type of mathematical relationship which _always_ hides some highly non-trivial structure behind an apparently simple pair of opposites. The sequence I'm talking about is evident in Section 4, where we explicitly pass from free energy to an entropy functional on beliefs to a self-entropy under a constraint. Sections 2 and 3 are all the backdrop to that sequence, motivating the _techniques_ used—not necessarily the paper itself.

So remember: in [Sak22], we don't set out to rewrite the FEP. We just need some better leverage to make sense of it, so we transform it a little. To paraphrase a quote by Chris Buckley, we've left the front, made gains elsewhere, and returned with new weapons. This is a common enough way of working in pure mathematics, but can be a bit tricky to get right. It's also tough to read without deconstructing a bit, but hopefully I've taken care of that here. One of the ultimate takeaways from this paper is that if one buys into max ent—and most people do—one automatically buys into some form of the free energy principle. Conversely, whenever one uses the FEP, they get max ent for free. This duality is the _method_ to our aim. It's ironic that in trying to make the FEP work, we ignore the FEP, but it's completely sensible that we end up bypassing it to prove statements about an equivalent structure. Moreover, some would say it's fitting that to get to biophysics we've had to go back to maximum entropy. I'd be inclined to agree, but again—if you are the sort of person to say that, this body of work posits that you have to recognise you're still secretly in favour of (some simple[^2] form of) the FEP.

A partner to this paper is on the way, which _does_ take all of this new stuff and contextualise it within the FEP. Here is where the duality and the passing to maximum entropy gets upgraded from a mere technical tool to an actual statement about the FEP, and about what it means, conceptually. Under Maxwell Ramstead's careful eye and the collective effort of the entire [lab](https://darsakthi.github.io/verses-lab/), each of whom is doing some phenomenal work to put this together, we aim to bring the construction more firmly to the FEP. My paper gets away from the FEP in several spots where entropy really takes over (there's a joke somewhere in there), and it has some unexplored implications for what the future of the FEP might look like, that we really wanted to address. Although not the stated aim, in effect I treat the FEP as an interesting question in biophysics that justifies doing some nice maths. It turns out I don't need to think about free energy at all, and we're off. The group's paper actually focusses on the FEP and relates these new results, derived in the context of entropy, to existing (and hopefully future) results in the FEP. 

To give an overview of the paper, the global pieces of the argument basically proceed like this: 

I first (S2) give a summarisation of three important pieces of information, namely, the FEP, maximum entropy, and the duality we are interested in. As I said, a key to the construction is that dual pairs are a special sort of equivalence: dualisation preserves a pair of objects (in fact, adjunctions are an isomorphism of Hom sets of objects, if that means anything to you). Simultaneously, they invert the morphisms between objects themselves. So, by dualising, we're telling the _same_ story from two totally _different_ points of view. This equivalence is important for us, because by establishing the duality holds, we prove that the FEP is true whenever max ent is true. That's good for the FEP, and allows us to go even further by using maximum entropy.

Next, I discuss what self-entropy could possibly mean in this context (S3), some philosophical or biophysical backdrop against which I can actually do some maths. Already we have fixed one issue with the FEP: the Markov blanket is nothing to fuss about, because it is ultimately a bit of a tautology, and simply evinces a definition of a system with controlled internal states that couple to any set of external states. Clearly we're on the right track, so constrained self-entropy is the way to go. 

In the beginning of S4, I actually construct the duality. This happens in two steps: 

- First, we go to constrained entropy over beliefs. In doing so, we can prove that systems which constrain themselves perform approximate Bayesian inference on average. This is Theorem 4.1.

- Secondly, we prove that putting a $$\mu$$ everywhere we see an $$\eta$$ and _vice versa_ changes nothing about the FEP. 

Here, it is the second theorem, Theorem 4.2, which proves the duality: that under the right constraints, constrained self-entropy gives us all of the features of the FEP. There's some technical work which needs doing in order to get there, but we do get there in the end.

In S4.1, I use this to make some sense of the formal structure of Bayesian mechanics. To paraphrase a quote from Lance Da Costa, this paper focusses on the synchronisation between internal and external, and reformulates it in terms of maximising entropy subject to some particular constraint; since maximising constrained entropy has been extensively studied in the past, the literature in this area can be put in the service of Bayesian mechanics.

In S4.2, I focus on how this illuminates the formal nature of random dynamics under the FEP. In particular, how does this affect our notions of ergodicity in the FEP? To that end I formulate a notion of local ergodicity, which is essentially a stand in for a probability density that arises from paths being constrained to an attractor. The nice thing is, this makes perfect sense mathematically, and patches some concerns about both ergodicity and attractors under the FEP. 

In S4.3 I zoom out a little to think about what this buys us in the context of the philosophy behind the FEP. This section is fairly self-explanatory.

Now, on to S6. In S6 I focus on some more esoteric aspects of both max ent and the FEP. One is related to my previous work on what I've called a constraint geometry; the interested reader can see what this is about [at an older blog post](https://darsakthi.github.io/posts/2022/03/HEP-EBL/). Three motifs become important.

In S6.1, I discuss gauge theory, giving a brief and probably too-terse-by-half overview of what a gauge theory is. I also talk a little about my parallel transport results, which get a little bit more attention in the post linked above. 

In S6.2, I elaborate on the statement that the target density is 'essentially a stand in for a probability density that arises from paths being constrained to an attractor.' This is given in a long proof, Theorem 6.1. I also discuss the infamous Helmholtz decomposition here, which turns out to be less frightening than it seems: it merely arises from a constraint geoemtry, and so in this simple case, is nothing but a gauge-symmetric aspect of maximum entropy.[^3] 

In S6.3 I discuss generalisations of all this to less simple cases like non-equilibria. We can get some results, but not great ones; so it remains a future task to extend this to genuine non-equilibra. 

By the end of it, we have essentially proven what Bayesian mechanics is and what it does. In particular, we have proven that (simple) systems which constrain themselves can be modelled as performing inference against those constraints, and that this constructs an attractor of system-like states, in a primitive version of allostasis-by-perception.

Zooming out a little bit once more, some material of independent interest has been discussed, especially a connection between the FEP and max ent (again, some would say it is not suprising at all that we had to ask questions about max ent to uncover the formal structure of the FEP; I would be inclined to agree—but following that, I'd point out that we did get the FEP back in the end). This places the FEP more transparently within both statistics and statistical physics. By connecting the FEP to max ent and both to biophysics, I believe this will be a more circumspect chapter for the FEP, where the maths is more careful, and the statements, less opaque.

[^1]: As usual, my motivation for this is along the lines of readability. For interdisciplinary audiences, like the target of this work, mathematical papers can be a bit inscrutable on a first read. That is to say, due to the common structure of papers in maths, they can be a quagmire of technical statements without all the perspective one would like—the idea is, this should help orient readers through the paper. Blogging informally or writing more expository material about one's results has become common in pure maths for this reason. Outside the proofs, this paper is quite reader friendly, though—the roadmap I've given here is nothing more or less detailed than the roadmaps in the paper.

[^2]: In a few places I refer to this as a simple form of the FEP. The difference in my eyes is that we're discussing states and not trajectories, and effective equilibria rather than genuine non-equilibria. I have a very brief paper about this forthcoming—in the next week or so, in fact—which is the precursor to doing the whole thing over again over paths to get to the 'real' FEP. Throughout, I find the example of a stone to be an interesting edge case that allows us to test the theory. It's interesting that this simplified version is most informative about boring things—stones and the like—clearly, there's more work to be done.

[^3]: Perhaps that's not actually less frightening.
