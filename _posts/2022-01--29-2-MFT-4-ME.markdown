---
title: 'More About What Mean Field Theory Actually Means'
date: 2022-01-29
permalink: /posts/2022/01/2-MFT-4-ME
layout: post
usemathjax: true
tags:
  - projects and papers
  - musings
---

The gift that continues to give is evidently [this set of notes](https://darsakthi.github.io/texts/ising-tutorial) I wrote recently on mean field theory, where I discuss a little about the formal, variational basis for mean field approximation.

In that paper, I _hint_ at a nice physical motivation for mean field theory—if we simplify a system to something that has certain effective dynamics, then interaction terms tend to go away, having the physical interpretation of suppressing fluctuations around a mean. It was pointed out to me by a dear reader that I never prove this in the paper, only suggesting that there is a relationship between simple non-interacting pictures and actual convergence to mean field dynamics. That is, I never explicitly show what puts the 'mean' in mean field theory. As an addendum to the paper indicated, I'll talk a little about this here, in this blog post. 

As I said in a [previous blog post](https://darsakthi.github.io/posts/2021/02/act-func/), one way of modelling the dynamics of the Ising model is by mean field theory (MFT), which looks at the ‘average’ dynamics of a system. The way we do MFT is by approximating the system with a simpler system that is related in some way to the original (specifically, we use a trial Hamiltonian for which the free energy is bounded from below by the Bogoliubov inequality). The typical way this is done, and in some sense the most meaningful, is by replacing the system with a ‘mean field’ and ignoring fluctuations in the dynamics of smaller items constituting the system. MFT is thus a theory of mean fields, ignoring the fluctuations around a mean (consider the transport relation $$\delta A(t) = A(t) - \langle A \rangle$$ for the dynamics of an observable $$A$$ in the presence of fluctuations. When we ignore fluctuations and the term $$\delta A(t)$$ vanishes, we have $$A(t) = \langle A \rangle$$).

There are ostensibly four steps to finding a mean field model formally. First, we pick a simpler trial Hamiltonian $$\hat H_0$$. The second is to find the trial free energy, and then note that the true free energy is bounded by the trial free energy plus a correction term in a control parameter $$\lambda$$, which is implicitly dependent on $$\hat H_0$$. This is the Bogoliubov inequality. The third step is to make sure the approximation is actually any good. If the corrective term is large, then we should try something a little more complex for $$\hat H_0$$. The fourth step is to minimise the variational free energy as it depends on $$m$$. The rationale behind this step is, if $$F_V(\lambda)$$ is strictly greater than $$F$$, its minimum is the place where it is closest to $$F$$. Since we minimise in the argument $$\lambda$$, this is the value for $$\lambda$$ at which the correction term vanishes. Now, simultaneously, minimising $$F_V$$ minimises $$F$$, such that we are really bringing their minima together. Since, by Landau theory, information about phase transitions follows from minima of $$F$$, this $$\lambda$$ is a semi-reliable approximation of some sort of order parameter, depending on how close $$\text{arg min} F_V(m)$$ actually gets to the minimum of $$F$$.  

In the Ising model, the canonical choice of $$\hat H_0$$ is $$m\sum_i s_i$$. This seems in conflict with our earlier approach, since it replaces interactions between spins, but has nothing to say of means _per se_.  And yet, I go on to say that supressing fluctuations is nothing but a short cut, which achieves a MFT by the same means as the formal procedure—neglecting those terms produces a simpler trial Hamiltonian, for which the free energy is strictly greater than the real one, which we minimise with respect to $$m$$. Likewise, [\[Sak22\]](https://scipost.org/SciPostPhysLectNotes.35) is thin on _physical_ motivation for MFT, but (I'd like to think) has plenty of mathematical motivation for MFT and physical motivation for magnetisation. Upon reflection this is a weakness of the paper. Can't always be perfect. In any case, the magnetisation function is reduced to the minimiser of the variational free energy functional. We choose a simpler Hamiltonian in a control parameter, and choose the value of that parameter which minimises the free energy of the trial Hamiltonian. The trial $$\hat H$$ assumes we can model the Ising model as a set of independent spins experiencing an effective field, rather than individual site-wise interactions. This is reasonable _a priori_, since if you are surrounded by a mosh of spins, and they are themselves surrounded by a mosh of spins, eventually you all converge to some sort of collective mosh-pit-type thing, which can be understood as any individual being situated in an effective push and pull. What that effective field must actually look like in order to approximate the true $$\hat H$$, esepcially such that their points of free energy minima approach each other, is the element of variational minimisation that happens in MFT. For those details, I'm happy to suggest my paper. To understand why that simpler effective field has anything to do with convergence to the mean, let's look at the Bogoliubov inequality. 

In the specific example of the Ising model, the Bogoliubov inequality (see equation two in the paper) is strictly minimised when 
[mathjax] \sum_{ij} s_i s_j = m \sum_i s_i. [/mathjax]
Let's assume the non-interacting Hamiltonian is a good approximation for the system. It follows that either $$s_i$$ or $$s_j$$ is equal to $$m$$. Without loss of generality, take $$s_j = m$$. Independently of that, expand 
[mathjax] \sum_{ij} s_i s_j = \sum_{ij} (\langle s_i \rangle + \delta s_i)(\langle s_j \rangle + \delta s_j), [/mathjax]
using the transport relation above. Assume fluctuations vanish for $$s_j$$. Then, we have 
[mathjax] \sum_{ij} s_i s_j =  \sum_{ij} s_i \langle s_j \rangle. [/mathjax] 
Clearly, if we ask that the effective field models the original Hamiltonian, then fluctuations going to zero and $$m = \langle s_j \rangle$$ is sufficient for $$F_V = F$$. In other words, if all the spins around a given $$s_i$$ centre around a mean of $$m$$, then the trial Hamiltonian with decoupled spins is a good model. Hence, MFT can be read as producing a statistical field theory—a field theory with probabilistic degrees of freedom—where every such variable regresses to some mean. As to what that mean is, the function for $$m$$ is the magnetisation function, which can be found by minimising $$F_V$$. Let's also take a moment to note that, as an order parameter, it makes some sense that $$m$$ should be a shared mean over all spins. For more on that, I can again point the reader to later sections of the paper mentioned above. 

We could have begun from spins rather than trial Hamiltonians, if we had so chosen. Assuming non-interacting spins implies $$\langle s_i s_j\rangle = \langle s_i \rangle \langle s_j \rangle$$. If fluctuations vanish for at least one variable, then this is guaranteed to be true, by linearity of the expectation. The non-interacting spins approach leads naturally to a Hamiltonian which looks like 
[mathjax] \langle s_j \rangle \sum_i s_i [/mathjax] by essentially the same argument as above. If the true $$\hat H$$ is equal to this Hamiltonian, then the corrective term is minimised, and $$F_V \approx F$$, especially at their minima. 

Finally, a note on the minimisation of variational free energy: the minimisation of free energy is about the stability of a configuration, and so it is tempting to say that minimising variational free energy tells us how something behaves. There are three somewhat independent ideas at hand: critical points (as in phase transitions) are the minima of thermodynamical free energy $$F$$, variational free energy is an upper bound on thermodynamical free energy, and assuming a simple system which matches the trial Hamiltonian minimises their difference. On the variational side, we can think of work and energy relationships only in an abstract theory space, where the minimum free energy model—the energetically favourable, stable model—is the model with no work left to be extracted from it, or, the model which has already been fully optimised. That said, if the system is simple enough that $$F = F_V$$, which in general is only possible when the Hamiltonian needn't be perturbed, then minimising variational free energy is trivially minimising $$F$$. Otherwise, we choose a Hamiltonian such that true and trial $$\hat H$$ are close to each other, assume this a faithful representation of the dynamics by some mean field argument, and then minimise both by minimising $$F_V$$. The function for $$m$$ that arises from finding magnetisation minimises both by minimising $$F_V$$, but the form of $$\hat H(m)$$ minimises $$\hat H - \hat H(m)$$ within $$F_V$$. Choosing $$m$$ as a control parameter is contingent on its eligibility to satisfy both these criteria, as a useful simplification that still captures useful dynamics. So, if our model 'magnetises' (n.b. scare quotes) like $$m$$, we assume the actual system will too—at least, approximately so.
